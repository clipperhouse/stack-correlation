!function($){var e={};$.ajaxSetup({cache:!0}),getJSONCached=function(t,a){var n=e[t];if(null!=n)return a&&a(n);var i=function(n){return e[t]=n,a&&a(n)};return $.getJSON(t+"&callback=?",i)};var t="//api.stackexchange.com/2.2/",a="&key=zg)SFUiAw3KznQKAw)AXzQ((",n={api_sites:function(e){return t+"sites?page="+e+"&pagesize=100&filter=!0U12eE-l6vTXjGb9hog*DtBLF"+a},api_tags:function(e,n){return t+"tags?pagesize=16&order=desc&sort=popular&inname="+encodeURIComponent(n)+"&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo"+a},api_tags_popular:function(e){return t+"tags?pagesize=5&order=desc&sort=popular&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo"+a},api_tag_count:function(e,n){return t+"questions?order=desc&sort=activity&tagged="+encodeURIComponent(n)+"&site="+e.api_site_parameter+"&filter=!LQa0AXyWeCS0eBBhfz)UnE"+a},api_tags_related:function(e,n){return t+"tags/"+encodeURIComponent(n)+"/related?site="+e.api_site_parameter+"&pagesize=10&filter=!n9Z4Y*b7KJ"+a},site_tag:function(e,t){return e.site_url.replace("http:","")+"/tags/"+encodeURIComponent(t)+"/info"},wikipedia_search:function(e){return"//en.wikipedia.org/w/index.php?search="+encodeURIComponent(e.replace(/\-/g," ").replace("#"," sharp"))}},i=function(e,t){for(var a=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();a.split(".").length>1&&a.split(".")[1].length<t;)a+="0";return a},r={},o={},s=null,p=$(document),c,l,u,m,g,f,h,d,_,v,C;p.on("ready",function(){getJSONCached(n.api_sites(1),function(e){for(var t=e.items,a=t.length,n=0;a>n;n++){var i=t[n];"main_site"===i.site_type&&0!==i.name.indexOf("Meta")&&"normal"===i.site_state&&(i.favicon_url=i.favicon_url.replace("http:",""),o[i.api_site_parameter]=i,null==s&&(s=i))}p.trigger("sites:load")}),c=$("#menu"),l=$("h1 > a"),C=$("input[name=tag]"),u=$(".site-name"),m=$(".tag-name"),g=$("#tag-correlations"),f=$("title"),h=$("#popular"),d=$("#tag-links"),_=d.find("a#so"),v=d.find("a#wikipedia"),C.autocomplete({source:function(e,t){getJSONCached(n.api_tags(r.site,e.term),function(e){for(var a=[],n=e.items,i=n.length,o=0;i>o;o++)item=n[o],a.push({label:item.name,value:item.name,href:"#"+r.site.api_site_parameter+"/"+encodeURIComponent(item.name)});t(a)})},select:function(e,t){location.href=t.item.href},autoFocus:!0,delay:200})}),p.on("sites:load",function(){for(var e in o)if(o.hasOwnProperty(e)){var t=o[e],a=$("<a>").attr("href","#"+t.api_site_parameter).html(t.name).css("background-image","url("+t.favicon_url+")");c.append(a),t.a=a}c.show(),p.trigger("menu:load")}),p.on("menu:load",function(){w(),window.onpopstate=w});var w=function(){var e=U(location.href);S(e)},U=function(e){var t={},a=e.split("#");if(a.length<2)return t.site=s,t;var n=a[1];a=n.split("/");var i=o[a[0]];return i&&(t.site=i),a.length>1&&(t.tag=decodeURIComponent(a[1])),t},S=function(e){r=e,I(r.site),r.tag?(R(r.site,r.tag),C.val(r.tag)):(C.val("").attr("placeholder","type a tag name here"),g.html(""),d.hide(),O(r.site))},I=function(e){e.a.addClass("selected").siblings().removeClass("selected"),u.html(e.name),l.css("background-image","url("+e.favicon_url+")").attr("href","#"+e.api_site_parameter)},O=function(e){getJSONCached(n.api_tags_popular(e),function(e){h.html("Popular: &nbsp;");for(var t=e.items,a=t.length,n=0;a>n;n++){item=t[n];var i=$("<a>").attr("href","#"+r.site.api_site_parameter+"/"+encodeURIComponent(item.name)).addClass("tag").html(item.name);h.append(i).append("&nbsp;")}h.show()})},R=function(e,t){getJSONCached(n.api_tag_count(e,t),function(a){k(e,t,a.total)})},k=function(e,t,a){getJSONCached(n.api_tags_related(e,t),function(r){for(var o=[],s=r.items,p=s.length,c=0;p>c;c++)item=s[c],o.push({tag:item.name,href:"#"+e.api_site_parameter+"/"+encodeURIComponent(item.name),site:e.api_site_parameter,favicon:e.favicon_url.replace("http:",""),url:e.site_url.replace("http:","")+"/questions/tagged/"+encodeURIComponent(t)+"+"+encodeURIComponent(item.name),correlation:0==c?"appears on "+i(100*item.count/a,0)+"% of ‘"+t+"’ questions":i(100*item.count/a,0)+"%"});var l={correlations:o},u=$("#correlations-tmpl").html(),f=Mustache.to_html(u,l);g.hide().html(f).fadeIn("fast"),h.hide(),m.html(t),_.attr("href",n.site_tag(e,t)),v.attr("href",n.wikipedia_search(t)),d.show()})};p.on("touchstart","a.tag",function(){return location.href=this.href,!1}),p.on("mouseover","a.tag",function(){J($(this))});var J=function(e){var t=U(e.attr("href"));getJSONCached(n.api_tag_count(t.site,t.tag),null),getJSONCached(n.api_tags_related(t.site,t.tag),null)}}(jQuery);
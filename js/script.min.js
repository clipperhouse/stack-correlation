$.ajaxSetup({cache:!0});var api_cache={};getJSONCached=function(e,t){var a=api_cache[e];if(null!=a)return t(a);var i=function(a){return api_cache[e]=a,t(a)};return $.getJSON(e+"&callback=?",i)};var api_key="zg)SFUiAw3KznQKAw)AXzQ((",urls={api_sites:function(e){return"//api.stackexchange.com/2.2/sites?page="+e+"&pagesize=100&filter=!0U12eE-l6vTXjGb9hog*DtBLF&key="+api_key},api_tags:function(e,t){return"//api.stackexchange.com/2.2/tags?pagesize=16&order=desc&sort=popular&inname="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo&key="+api_key},api_tags_popular:function(e){return"//api.stackexchange.com/2.2/tags?pagesize=4&order=desc&sort=popular&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo&key="+api_key},api_tag_count:function(e,t){return"//api.stackexchange.com/2.2/questions?order=desc&sort=activity&tagged="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!LQa0AXyWeCS0eBBhfz)UnE&key="+api_key},api_tags_related:function(e,t){return"//api.stackexchange.com/2.2/tags/"+encodeURIComponent(t)+"/related?site="+e.api_site_parameter+"&key="+api_key+"&pagesize=10&filter=!n9Z4Y*b7KJ"},site_tag:function(e,t){return e.site_url.replace("http:","")+"/tags/"+encodeURIComponent(t)+"/info"},wikipedia_search:function(e){return"//en.wikipedia.org/w/index.php?search="+encodeURIComponent(e.replace(/\-/g," ").replace("#"," sharp"))}},round=function(e,t){for(var a=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();a.split(".").length>1&&a.split(".")[1].length<t;)a+="0";return a},state={};$(function(){var e=$(document),t=$("#sites");!function(){getJSONCached(urls.api_sites(1),function(a){for(var i=a.items,n=i.length,r=0;n>r;r++){var s=i[r];if("main_site"===s.site_type&&0!==s.name.indexOf("Meta")&&"normal"===s.site_state){s.favicon_url=s.favicon_url.replace("http:","");var o=$("<a>").data("site",s).attr("href","#"+s.api_site_parameter).html(s.name).css("background-image","url("+s.favicon_url+")");t.append(o)}}t.show(),e.trigger("sites:load")})}();var a=$("h1"),i=$(".site-name"),n=$(".tag-name"),r=$("#tag-correlations"),s=$("title"),o=$("#popular"),c=$("#tag-links"),p=function(e){var t=e.split("/"),a=t[0],i=u(a);if(!i)return void(location.hash="");h(i);var n=i.data("site");state.site=n,m(n);var s;e.length>1&&(s=t[1]),s?(d(n,s),v.val(s)):(r.html(""),c.hide(),v.val("").attr("placeholder","type a tag name here"),o.show()),v.focus().select()},l=function(){if(location.hash.length>1){var e=location.hash.replace(/^#+/,"");return void p(e)}var a=t.children().eq(0),i=a.data("site");p(i.api_site_parameter)};window.onpopstate=l,e.on("sites:load",l);var u=function(e){for(var a=t.children(),i=0;i<a.length;i++){var n=$(a[i]),r=n.data("site");if(r.api_site_parameter===e)return n}return null},h=function(e){e.addClass("selected").siblings().removeClass("selected");var t=e.data("site");i.html(t.name),a.css("background-image","url("+t.favicon_url.replace("http:","")+")")},m=function(e){getJSONCached(urls.api_tags_popular(e),function(e){o.html("Popular: &nbsp;");for(var t=e.items,a=t.length,i=0;a>i;i++){item=t[i];var n=$("<a>").attr("href","#"+state.site.api_site_parameter+"/"+item.name).addClass("tag").html(item.name);o.append(n).append("&nbsp;")}})},d=function(e,t){getJSONCached(urls.api_tag_count(e,t),function(a){_(e,t,a.total)})},g=c.find("a#so"),f=c.find("a#wikipedia"),_=function(e,t,a){getJSONCached(urls.api_tags_related(e,t),function(i){for(var s=[],p=i.items,l=p.length,u=0;l>u;u++)item=p[u],s.push({tag:item.name,site:e.api_site_parameter,favicon:e.favicon_url.replace("http:",""),url:e.site_url.replace("http:","")+"/questions/tagged/"+encodeURIComponent(t)+"+"+encodeURIComponent(item.name),correlation:0==u?"appears on "+round(100*item.count/a,0)+"% of ‘"+t+"’ questions":round(100*item.count/a,0)+"%"});var h={correlations:s},m=$("#correlations-tmpl").html(),d=Mustache.to_html(m,h);r.hide().html(d).fadeIn("fast"),o.hide(),n.html(t),g.attr("href",urls.site_tag(e,t)),f.attr("href",urls.wikipedia_search(t)),c.show()})},v=$("input[name=tag]");v.autocomplete({source:function(e,t){getJSONCached(urls.api_tags(state.site,e.term),function(e){for(var a=[],i=e.items,n=i.length,r=0;n>r;r++)item=i[r],a.push({label:item.name,value:item.name,spec:state.site.api_site_parameter+"/"+item.name});t(a)})},select:function(e,t){location.href="#"+t.item.spec},autoFocus:!0,delay:200})});
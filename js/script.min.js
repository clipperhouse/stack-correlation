!function(e){var t={};e.ajaxSetup({cache:!0}),getJSONCached=function(a,n){var i=t[a];if(null!=i)return n&&n(i);var r=function(e){return t[a]=e,n&&n(e)};return e.getJSON(a+"&callback=?",r)};var a,n,i,r,o,s,p,c,l,u,m,g="https://api.stackexchange.com/2.2/",f="&key=zg)SFUiAw3KznQKAw)AXzQ((",h={api_sites:function(e){return g+"sites?page="+e+"&pagesize=100&filter=!0U12eE-l6vTXjGb9hog*DtBLF"+f},api_tags:function(e,t){return g+"tags?pagesize=16&order=desc&sort=popular&inname="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo"+f},api_tags_popular:function(e){return g+"tags?pagesize=5&order=desc&sort=popular&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo"+f},api_tag_count:function(e,t){return g+"questions?order=desc&sort=activity&tagged="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!LQa0AXyWeCS0eBBhfz)UnE"+f},api_tags_related:function(e,t){return g+"tags/"+encodeURIComponent(t)+"/related?site="+e.api_site_parameter+"&pagesize=10&filter=!n9Z4Y*b7KJ"+f},site_tag:function(e,t){return e.site_url.replace("http:","")+"/tags/"+encodeURIComponent(t)+"/info"},wikipedia_search:function(e){return"//en.wikipedia.org/w/index.php?search="+encodeURIComponent(e.replace(/\-/g," ").replace("#"," sharp"))}},d=function(e,t){for(var a=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();a.split(".").length>1&&a.split(".")[1].length<t;)a+="0";return a},_={},v={},C=null,w=e(document);e(function(){getJSONCached(h.api_sites(1),function(e){for(var t=e.items,a=t.length,n=0;n<a;n++){var i=t[n];"main_site"===i.site_type&&0!==i.name.indexOf("Meta")&&"normal"===i.site_state&&(i.favicon_url=i.favicon_url.replace("http:",""),v[i.api_site_parameter]=i,null==C&&(C=i))}w.trigger("sites:load")}),a=e("#menu"),n=e("h1 > a"),m=e("input[name=tag]"),i=e(".site-name"),r=e(".tag-name"),o=e("#tag-correlations"),s=e("title"),p=e("#popular"),c=e("#tag-links"),l=c.find("a#so"),u=c.find("a#wikipedia"),m.autocomplete({source:function(e,t){getJSONCached(h.api_tags(_.site,e.term),function(e){for(var a=[],n=e.items,i=n.length,r=0;r<i;r++)item=n[r],a.push({label:item.name,value:item.name,href:"#"+_.site.api_site_parameter+"/"+encodeURIComponent(item.name)});t(a)})},select:function(e,t){location.href=t.item.href},autoFocus:!0,delay:200})}),w.on("sites:load",function(){for(var t in v)if(v.hasOwnProperty(t)){var n=v[t],i=e("<a>").attr("href","#"+n.api_site_parameter).html(n.name).css("background-image","url("+n.favicon_url+")");a.append(i),n.a=i}a.show(),w.trigger("menu:load")}),w.on("menu:load",function(){U(),window.onpopstate=U});var U=function(){var e=S(location.href);I(e)},S=function(e){var t={},a=e.split("#");if(a.length<2)return t.site=C,t;var n=a[1];a=n.split("/");var i=v[a[0]];return i&&(t.site=i),a.length>1&&(t.tag=decodeURIComponent(a[1])),t},I=function(e){_=e,N(_.site),_.tag?(R(_.site,_.tag),m.val(_.tag)):(m.val("").attr("placeholder","type a tag name here"),o.html(""),c.hide(),O(_.site))},N=function(e){e.a.addClass("selected").siblings().removeClass("selected"),i.html(e.name),n.css("background-image","url("+e.favicon_url+")").attr("href","#"+e.api_site_parameter)},O=function(t){getJSONCached(h.api_tags_popular(t),function(t){p.html("Popular: &nbsp;");for(var a=t.items,n=a.length,i=0;i<n;i++){item=a[i];var r=e("<a>").attr("href","#"+_.site.api_site_parameter+"/"+encodeURIComponent(item.name)).addClass("tag").html(item.name);p.append(r).append("&nbsp;")}p.show()})},R=function(e,t){getJSONCached(h.api_tag_count(e,t),function(a){k(e,t,a.total)})},k=function(t,a,n){getJSONCached(h.api_tags_related(t,a),function(i){for(var s=[],m=i.items,g=m.length,f=0;f<g;f++)item=m[f],item.name!=a&&isNaN(item.name.replace(a,""))&&s.push({tag:item.name,href:"#"+t.api_site_parameter+"/"+encodeURIComponent(item.name),site:t.api_site_parameter,favicon:t.favicon_url.replace("http:",""),url:t.site_url.replace("http:","")+"/questions/tagged/"+encodeURIComponent(a)+"+"+encodeURIComponent(item.name),correlation:0==f?"appears on "+d(100*item.count/n,0)+"% of ‘"+a+"’ questions":d(100*item.count/n,0)+"%"});var _={correlations:s},v=e("#correlations-tmpl").html(),C=Mustache.to_html(v,_);o.hide().html(C).fadeIn("fast"),p.hide(),r.html(a),l.attr("href",h.site_tag(t,a)),u.attr("href",h.wikipedia_search(a)),c.show()})};w.on("touchstart","a.tag",function(){return location.href=this.href,!1}),w.on("mouseover","a.tag",function(){J(e(this))});var J=function(e){var t=S(e.attr("href"));getJSONCached(h.api_tag_count(t.site,t.tag),null),getJSONCached(h.api_tags_related(t.site,t.tag),null)}}(jQuery);
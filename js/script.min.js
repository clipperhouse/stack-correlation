$.ajaxSetup({cache:!0});var api_cache={};getJSONCached=function(e,t){var a=api_cache[e];if(null!=a)return t(a);var i=function(a){return api_cache[e]=a,t(a)};return $.getJSON(e+"&callback=?",i)};var api_key="zg)SFUiAw3KznQKAw)AXzQ((",urls={api_sites:function(e){return"//api.stackexchange.com/2.2/sites?page="+e+"&pagesize=100&filter=!0U12eE-l6vTXjGb9hog*DtBLF&key="+api_key},api_tags:function(e,t){return"//api.stackexchange.com/2.2/tags?pagesize=16&order=desc&sort=popular&inname="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo&key="+api_key},api_tags_popular:function(e){return"//api.stackexchange.com/2.2/tags?pagesize=4&order=desc&sort=popular&site="+e.api_site_parameter+"&filter=!*M27MxijjqVg4jGo&key="+api_key},api_tag_count:function(e,t){return"//api.stackexchange.com/2.2/questions?order=desc&sort=activity&tagged="+encodeURIComponent(t)+"&site="+e.api_site_parameter+"&filter=!LQa0AXyWeCS0eBBhfz)UnE&key="+api_key},api_tags_related:function(e,t){return"//api.stackexchange.com/2.2/tags/"+encodeURIComponent(t)+"/related?site="+e.api_site_parameter+"&key="+api_key+"&pagesize=14&filter=!n9Z4Y*b7KJ"}},round=function(e,t){for(var a=(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toString();a.split(".").length>1&&a.split(".")[1].length<t;)a+="0";return a},state={};$(function(){var e=$(document),t=$("#sites");!function(){getJSONCached(urls.api_sites(1),function(a){for(var i=a.items,n=i.length,r=0;n>r;r++){var o=i[r];if("main_site"===o.site_type&&0!==o.name.indexOf("Meta")&&"normal"===o.site_state){o.favicon_url=o.favicon_url.replace("http:","");var s=$("<a>").attr("href","#"+o.api_site_parameter).html(o.name).css("background-image","url("+o.favicon_url+")"),c=$("<li/>").append(s).data("site",o);t.append(c)}}t.show(),e.trigger("sites:load")})}();var a=$("#site-name"),i=$("#tag-correlations"),n=$("title"),r=$("#popular"),o=function(e){var t=e.split("/"),a=t[0],n=c(a);if(!n)return void(location.hash="");p(n);var r=n.data("site");state.site=r,l(r);var o;e.length>1&&(o=t[1]),o?(u(r,o),g.val(o)):(i.html(""),g.val("").attr("placeholder","type a tag name here")),g.focus().select()},s=function(){if(location.hash.length>1){var e=location.hash.replace(/^#+/,"");return void o(e)}var a=t.children("li").eq(0),i=a.data("site");o(i.api_site_parameter)};window.onpopstate=s,e.on("sites:load",s);var c=function(e){for(var a=t.children("li"),i=0;i<a.length;i++){var n=$(a[i]),r=n.data("site");if(r.api_site_parameter===e)return n}return null},p=function(e){e.addClass("selected").siblings().removeClass("selected");var t=e.data("site");a.html(t.name+" tag correlations").css("background-image","url("+t.favicon_url.replace("http:","")+")")},l=function(e){getJSONCached(urls.api_tags_popular(e),function(e){r.html("Popular: &nbsp;");for(var t=e.items,a=t.length,i=0;a>i;i++){item=t[i];var n=$("<a>").attr("href","#"+state.site.api_site_parameter+"/"+item.name).addClass("tag").html(item.name);r.append(n)}})},u=function(e,t){getJSONCached(urls.api_tag_count(e,t),function(a){m(e,t,a.total)})},m=function(e,t,a){return getJSONCached(urls.api_tags_related(e,t),function(n){for(var r=[],o=n.items,s=o.length,c=0;s>c;c++)item=o[c],r.push({tag:item.name,site:e.api_site_parameter,favicon:e.favicon_url.replace("http:",""),url:e.site_url.replace("http:","")+"/questions/tagged/"+encodeURIComponent(t)+"+"+encodeURIComponent(item.name),correlation:0==c?"appears on "+round(100*item.count/a,0)+"% of ‘"+t+"’ questions":round(100*item.count/a,0)+"%"});var p={correlations:r},l=$("#correlations-tmpl").html(),u=Mustache.to_html(l,p);return i.hide().html(u).fadeIn("fast"),g.focus().select()})},g=$("input[name=tag]");g.autocomplete({source:function(e,t){getJSONCached(urls.api_tags(state.site,e.term),function(e){for(var a=[],i=e.items,n=i.length,r=0;n>r;r++)item=i[r],a.push({label:item.name,value:item.name,spec:state.site.api_site_parameter+"/"+item.name});t(a)})},select:function(e,t){location.href="#"+t.item.spec},autoFocus:!0,delay:200})});